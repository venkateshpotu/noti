<html>
    <title>Firebase Messaging Demo</title>
    <style>
        div {
            margin-bottom: 15px;
        }
    </style>
    <body>
        <div id="token"></div>
        <div id="msg"></div>
        <div id="notis"></div>
        <div id="err"></div>
        <div><button type="submit" class="firebasesub"></button></div>
        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
        <script src="https://www.gstatic.com/firebasejs/8.4.2/firebase-app.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.16.1/firebase-messaging.js"></script>
        <script>

            $(".firebasesub").click(function (e) { 
                e.preventDefault();
                alert("cxvxcv");
                callaj()
            });
            function callaj(){
                $.ajax({
        type: 'POST',
        url: "https://fcm.googleapis.com/fcm/send",
        headers: {
            Authorization: 'key=AAAADCfaIXs:APA91bF4PUIHJWicRqly7o3PJ8dM5hnpa9UutXgs6iOZTHESupKNkoLlY2JDPqP7QXh3UNRnDOlOE7UWUllQEnuHio54k_Mi0k6f57Gv-vUfRcudyk5Yl53EtqIKS5__NcTpGW4mJhxX'
        },
        contentType: 'application/json',
        dataType: 'json',
        data: JSON.stringify({
            "to": "eMzdYssT0zsilwIZUvqKb3:APA91bGJ4LgHkZ4BXvUU6qOoQ1SBYCIgZNtYgd6CM1c67n4NZ3bOwWowmWXw_tB0Gybhp3bes55grgw3QdGhKL33_ncc0BPn4owx5ADptaPV-pOlBChGcAjROlU8jujKlY6ZLuNk1TyH",
            "priority": "high",
            "notification": {
                "title": "test",
                "body": "shisdhdsf"
            }
        }),
        success: function(responseData) {
            alert("Success");
        },
        error: function(jqXhr, textStatus, errorThrown) {
            /*alert("Fail");*/   // alerting "Fail" isn't useful in case of an error...
            alert("Status: " + textStatus + "\nError: " + errorThrown);
        }
            });
            }
            

            MsgElem = document.getElementById('msg');
            TokenElem = document.getElementById('token');
            NotisElem = document.getElementById('notis');
            ErrElem = document.getElementById('err');
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyCGzPm_gySTNvjQwlmUbHyH8FVybs60GCk",
    authDomain: "notification-6ebd4.firebaseapp.com",
    projectId: "notification-6ebd4",
    storageBucket: "notification-6ebd4.appspot.com",
    messagingSenderId: "52208214395",
    appId: "1:52208214395:web:8bca9a0a33272c67301dde",
    measurementId: "G-WH9149W6H9"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
            

            const messaging = firebase.messaging();
            messaging
                .requestPermission()
                .then(function () {
                    MsgElem.innerHTML = 'Notification permission granted.';
                    console.log('Notification permission granted.');

                    // get the token in the form of promise
                    return messaging.getToken();
                })
                .then(function (token) {
                    TokenElem.innerHTML = 'Device token is : <br>' + token;
                })
                .catch(function (err) {
                    ErrElem.innerHTML = ErrElem.innerHTML + '; ' + err;
                    console.log('Unable to get permission to notify.', err);
                });

            let enableForegroundNotification = true;
            messaging.onMessage(function (payload) {
                console.log('Message received. ', payload);
                NotisElem.innerHTML =
                    NotisElem.innerHTML + JSON.stringify(payload);
                if (enableForegroundNotification) {
                    let notification = payload.notification;
                    navigator.serviceWorker
                        .getRegistrations()
                        .then((registration) => {
                            registration[0].showNotification(notification.title);
                        });
                }
            });
        </script>
                                        
<!-- PushAlert -->
<script type="text/javascript">
    (function(d, t) {
            var g = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
            g.src = "https://cdn.pushalert.co/integrate_f9fd4ccd5c641dff795c7e14a6dc4f34.js";
            s.parentNode.insertBefore(g, s);
    }(document, "script"));
</script>
<!-- End PushAlert -->
                
    </body>
</html>
